
<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Futebol M√°ximo - Tracker V√≠deos Tab Only</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background:#111; color:#fff; display:flex; }
.sidebar { width:250px; background:#000; padding:20px; display:flex; flex-direction:column; align-items:flex-start; }
.logo { font-size:20px; font-weight:bold; margin-bottom:30px; color:#4CAF50; }
.menu-item { margin:10px 0; cursor:pointer; padding:10px; border-radius:5px; }
.menu-item:hover { background:#222; }
.main-content { flex:1; padding:20px; overflow-y:auto; }
.header { display:flex; justify-content:space-between; align-items:center; }
.btn { background:#4CAF50; border:none; padding:10px 20px; border-radius:5px; color:#fff; cursor:pointer; font-size:16px; }
.btn:hover { background:#45a049; }
.list-container { margin-top:20px; display:grid; grid-template-columns:1fr; gap:10px; }
.list-item { background:#222; padding:15px; border-radius:8px; cursor:pointer; }
.video-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:12px; margin-top:12px; }
.video-card { background:#181818; border-radius:8px; overflow:hidden; }
.video-card img { width:100%; display:block; }
.video-title { padding:8px; font-size:14px; }
.video-info { padding:0 8px 8px 8px; font-size:12px; color:#aaa; }
.modal { position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.6); }
.modal.show { display:grid; }
.dialog { background:#222; padding:20px; border-radius:10px; width:100%; max-width:400px; }
.input { width:100%; padding:10px; border-radius:6px; border:none; margin-top:10px; }
</style>
</head>
<body>

<div class="sidebar">
  <div class="logo">‚öΩ Futebol M√°ximo</div>
  <div class="menu-item" onclick="showSavedChannels()">üì∫ Saved Channels</div>
</div>

<div class="main-content">
  <div class="header">
    <h1 id="pageTitle">Saved Channels</h1>
    <button class="btn" onclick="openModal('createList')">+ Criar Lista</button>
  </div>
  <div id="listsGrid" class="list-container"></div>
  <div id="listView" style="display:none">
    <button class="btn" onclick="backToLists()">‚Üê Voltar</button>
    <h2 id="listName"></h2>
    <button class="btn" onclick="openModal('addChannel')">+ Adicionar Canal</button>
    <div id="videosGrid" class="video-grid"></div>
  </div>
</div>

<div id="modalCreate" class="modal">
  <div class="dialog">
    <h3>Criar Lista</h3>
    <input id="inputListName" class="input" placeholder="Nome da lista">
    <div style="margin-top:10px;text-align:right">
      <button class="btn" onclick="closeModal('createList')">Cancelar</button>
      <button class="btn" onclick="saveList()">Salvar</button>
    </div>
  </div>
</div>

<div id="modalChannel" class="modal">
  <div class="dialog">
    <h3>Adicionar Canal</h3>
    <input id="inputChannelUrl" class="input" placeholder="https://www.youtube.com/@username/videos">
    <div style="margin-top:10px;text-align:right">
      <button class="btn" onclick="closeModal('addChannel')">Cancelar</button>
      <button class="btn" onclick="addChannel()">Trackear</button>
    </div>
  </div>
</div>

<script>
let state = JSON.parse(localStorage.getItem("tracker_state") || '{"lists":[]}');
let currentListId = null;

function saveState() { localStorage.setItem("tracker_state", JSON.stringify(state)); }
function renderLists() {
  document.getElementById("listView").style.display = "none";
  document.getElementById("listsGrid").innerHTML = "";
  state.lists.forEach(list => {
    const el = document.createElement("div");
    el.className = "list-item";
    el.textContent = list.name;
    el.onclick = () => openList(list.id);
    document.getElementById("listsGrid").appendChild(el);
  });
}

function openList(id) {
  currentListId = id;
  const list = state.lists.find(l=>l.id===id);
  document.getElementById("pageTitle").textContent = list.name;
  document.getElementById("listName").textContent = list.name;
  document.getElementById("listsGrid").style.display = "none";
  document.getElementById("listView").style.display = "block";
  renderVideos(list.videos || []);
}

function openModal(type) { document.getElementById(type==='createList'?'modalCreate':'modalChannel').classList.add("show"); }
function closeModal(type) { document.getElementById(type==='createList'?'modalCreate':'modalChannel').classList.remove("show"); }

function saveList() {
  const name = document.getElementById("inputListName").value.trim();
  if(!name) return;
  state.lists.push({ id: Date.now(), name, channels: [], videos: [] });
  saveState();
  renderLists();
  closeModal('createList');
  document.getElementById("inputListName").value = "";
}

function backToLists() {
  document.getElementById("listView").style.display = "none";
  document.getElementById("listsGrid").style.display = "grid";
  document.getElementById("pageTitle").textContent = "Saved Channels";
}

async function addChannel() {
  const url = document.getElementById("inputChannelUrl").value.trim();
  if(!url) return;
  closeModal('addChannel');
  await fetchVideosFromVideosTab(url);
}

async function fetchVideosFromVideosTab(channelVideosUrl) {
  try {
    const resp = await fetch(channelVideosUrl);
    const text = await resp.text();
    const jsonMatch = text.match(/var ytInitialData = (.*?);<\/script>/s);
    if(!jsonMatch) { alert("N√£o foi poss√≠vel ler os v√≠deos"); return; }
    const data = JSON.parse(jsonMatch[1]);
    const videoItems = [];
    const tabs = data.contents.twoColumnBrowseResultsRenderer.tabs;
    const videosTab = tabs.find(t=>t.tabRenderer?.title==="Videos");
    const gridItems = videosTab.tabRenderer.content.sectionListRenderer.contents;
    gridItems.forEach(section=>{
      const items = section.itemSectionRenderer?.contents || [];
      items.forEach(item=>{
        const video = item.gridVideoRenderer;
        if(video) {
          videoItems.push({
            id: video.videoId,
            title: video.title.runs[0].text,
            thumb: video.thumbnail.thumbnails.pop().url,
            publishedAt: video.publishedTimeText?.simpleText || "",
            views: video.viewCountText?.simpleText || "",
            duration: video.lengthText?.simpleText || ""
          });
        }
      });
    });
    const list = state.lists.find(l=>l.id===currentListId);
    videoItems.sort((a,b)=>new Date(b.publishedAt)-new Date(a.publishedAt));
    list.videos = videoItems;
    renderVideos(videoItems);
    saveState();
  } catch(e) {
    console.error("Erro ao obter v√≠deos da aba videos:", e);
    alert("Erro ao obter v√≠deos da aba videos.");
  }
}

function renderVideos(videos) {
  const grid = document.getElementById("videosGrid");
  grid.innerHTML = "";
  videos.forEach(v=>{
    const el = document.createElement("div");
    el.className="video-card";
    el.innerHTML = `
      <img src="${v.thumb}">
      <div class="video-title">${v.title}</div>
      <div class="video-info">
        Dura√ß√£o: ${v.duration} | Views: ${v.views} | Publicado: ${v.publishedAt}
      </div>
    `;
    grid.appendChild(el);
  });
}

renderLists();
</script>
</body>
</html>
